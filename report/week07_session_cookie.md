# ✅ 세션(Session)과 쿠키(Cookie) 기반 인증 흐름 정리

## 🔸 1. 상태 유지 전략이 필요한 이유

### HTTP의 특징

- **Stateless (무상태)**

  - 서버는 각 요청 간 클라이언트의 상태를 저장하지 않음
  - 모든 요청은 독립적이며 이전 요청과 연결되지 않음

- **Connectionless (비연결)**
  - 요청-응답 후 연결이 끊기며, 매 요청마다 다시 연결 필요

👉 이로 인해 사용자의 로그인 상태 등 "상태 유지"가 필요함

---

## 🔸 2. 상태 유지 전략 비교

### ✅ 세션(Session)

#### ✔️ 개념

- 클라이언트 상태를 서버가 저장
- 클라이언트에는 식별자(session ID)만 저장 → 쿠키로 전송됨

#### ✔️ 동작 흐름

1. 클라이언트가 로그인 요청
2. 서버가 세션 생성 및 `session_id` 발급
3. `Set-Cookie`로 브라우저에 `session_id` 전달
4. 이후 모든 요청에 `session_id`가 자동 포함
5. 서버는 해당 ID로 클라이언트 상태를 확인

#### ✔️ 특징 요약

| 항목        | 세션(Session)                   |
| ----------- | ------------------------------- |
| 저장 위치   | 서버                            |
| 보안성      | 높음 (클라이언트에서 접근 불가) |
| 데이터 형식 | 객체 등 복잡한 구조 가능        |
| 유효 기간   | 브라우저 종료 시 or 명시적 설정 |
| 사용 예     | 로그인 상태, 장바구니 등        |

---

### ✅ 쿠키(Cookie)

#### ✔️ 개념

- 데이터를 브라우저에 직접 저장
- 요청 시 쿠키가 자동으로 서버에 포함되어 전송됨

#### ✔️ 동작 흐름

1. 클라이언트가 사이트 방문
2. 서버가 `Set-Cookie` 헤더로 쿠키 전송
3. 브라우저가 쿠키 저장
4. 이후 요청 시 브라우저가 쿠키 포함하여 전송

#### ✔️ 쿠키 예시

```ts
 Set-Cookie: session_id=abc123; HttpOnly; Secure; Max-Age=3600; Path=/
```

- `session_id=abc123`: 쿠키 이름과 값
- `HttpOnly`: JavaScript에서 접근 차단 (보안 강화)
- `Secure`: HTTPS 환경에서만 쿠키 전송
- `Max-Age=3600`: 1시간 동안 유지
- `Path=/`: 전체 경로에 적용

#### ✔️ 특징 요약

| 항목        | 쿠키(Cookie)              |
| ----------- | ------------------------- |
| 저장 위치   | 클라이언트(브라우저)      |
| 보안성      | 낮음 (조작 가능)          |
| 데이터 형식 | 문자열만 가능 (key=value) |
| 유효 기간   | `Max-Age`, `Expires` 설정 |
| 사용 예     | 자동 로그인, 다크모드 등  |

---

## 🔸 3. 세션 vs 쿠키 비교 요약

| 구분        | 세션(Session)                      | 쿠키(Cookie)                   |
| ----------- | ---------------------------------- | ------------------------------ |
| 저장 위치   | 서버                               | 클라이언트(브라우저)           |
| 유지 방식   | 세션 ID 기반 서버 관리             | 브라우저가 자동 전송           |
| 보안성      | 높음                               | 낮음                           |
| 용량 제한   | 제한 없음 (서버 메모리 사용)       | 4KB (도메인당 최대 20개)       |
| 유효 기간   | 설정 가능, 기본은 브라우저 종료 시 | `Max-Age`, `Expires` 설정 가능 |
| 데이터 형식 | 객체 등 복잡한 구조 가능           | 문자열 (key-value 쌍)          |
| 사용 예     | 로그인 상태, 장바구니 등           | 자동 로그인, UI 상태 저장 등   |

---

## 🔸 4. 로그인 인증 예시 (세션 기반)

1. 사용자가 `example.com/login`으로 로그인
2. 서버가 로그인 성공 시 `session_id` 생성
3. 응답 시 `Set-Cookie` 헤더로 `session_id` 전송
